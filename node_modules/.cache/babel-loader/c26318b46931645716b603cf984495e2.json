{"remainingRequest":"D:\\Desktop\\pagepro\\lsying\\node_modules\\thread-loader\\dist\\cjs.js!D:\\Desktop\\pagepro\\lsying\\node_modules\\babel-loader\\lib\\index.js!D:\\Desktop\\pagepro\\lsying\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\Desktop\\pagepro\\lsying\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Desktop\\pagepro\\lsying\\src\\views\\deviceoperate\\list\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\Desktop\\pagepro\\lsying\\src\\views\\deviceoperate\\list\\index.vue","mtime":1609569561000},{"path":"D:\\Desktop\\pagepro\\lsying\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Desktop\\pagepro\\lsying\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Desktop\\pagepro\\lsying\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\Desktop\\pagepro\\lsying\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Desktop\\pagepro\\lsying\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _objectSpread from \"D:/Desktop/pagepro/lsying/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport \"core-js/modules/es6.array.find\";\nimport \"core-js/modules/es7.array.includes\";\nimport \"core-js/modules/es6.string.includes\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport waves from \"@/directive/waves\";\nimport Pagination from \"@/components/Pagination\";\nimport DeviceDialog from \"./components/dialog\";\nimport deviceApi from \"@/api/device/device-list-api\";\nimport productApi from \"@/api/product/product-api\";\nvar stateEnum = {\n  0: \"已下架\",\n  1: \"已上架\"\n};\nvar stateClassEnum = {\n  0: \"danger\",\n  1: \"success\"\n};\nexport default {\n  name: \"DeviceList\",\n  components: {\n    DeviceDialog: DeviceDialog,\n    Pagination: Pagination\n  },\n  directives: {\n    waves: waves\n  },\n  filters: {\n    statusFilter: function statusFilter(status) {\n      if (status === 0) {\n        return \"info\";\n      } else if (status === 1) {\n        return \"success\";\n      } else if (status === 2) {\n        return \"warning\";\n      }\n    },\n    stateClassFilter: function stateClassFilter(state) {\n      return stateClassEnum[state];\n    },\n    stateFilter: function stateFilter(state) {\n      return stateEnum[state];\n    }\n  },\n  data: function data() {\n    return {\n      tableKey: 0,\n      list: null,\n      deviceList: null,\n      // 设备列表\n      total: 0,\n      listLoading: false,\n      sortColumn: \"id\",\n      sortAsc: false,\n      listQuery: {\n        pageIndex: 1,\n        pageSize: 10,\n        keyword: null,\n        name: null,\n        code: null,\n        state: null,\n        pageSorts: []\n      },\n      stateOptions: [{\n        label: \"已删除\",\n        value: 1\n      }, {\n        label: \"未删除\",\n        value: 0\n      }],\n      tableColumnChecked: null,\n      searchColumn: \"keyword\",\n      searchValue: null,\n      searchOptions: [{\n        label: \"全部\",\n        value: \"keyword\"\n      }, {\n        label: \"角色名称\",\n        value: \"name\"\n      }, {\n        label: \"角色编码\",\n        value: \"code\"\n      }],\n      createTimeRange: null,\n      showReviewer: true,\n      dialogStatus: \"\",\n      textMap: {\n        update: \"Edit\",\n        create: \"Create\"\n      },\n      dialogPvVisible: false,\n      pvData: [],\n      downloadLoading: false,\n      deviceId: \"\",\n      // 设备id\n      copyObj: {},\n      // 拷贝对象\n      origin: window.location.protocol + \"//\" + window.location.hostname + \":8888\",\n      // 获取所有商品\n      isGetAllList: false,\n      // device tag\n      tags: [],\n      selectTag: {}\n    };\n  },\n  created: function created() {\n    this.setDefaultSort(); // this.getPageListBydid();\n\n    this.getDeviceList();\n    this.isGetAllList = JSON.parse(sessionStorage.userInfo).loginSysUserVo.permissionCodes.includes(\"admin:commodity:page\");\n  },\n  methods: {\n    getList: function getList() {\n      var _this = this;\n\n      this.deviceId = \"\";\n      this.listLoading = true;\n      productApi.getPageList(this.listQuery).then(function (response) {\n        _this.list = response.data.records;\n        _this.total = response.data.total;\n        _this.listLoading = false;\n      });\n    },\n    getPageListBydid: function getPageListBydid(deviceId) {\n      var _this2 = this;\n\n      if (!deviceId) {\n        this.$message.warning(\"请选择设备后在操作\");\n        return;\n      }\n\n      this.listLoading = true;\n      productApi.getPageListBydid(this.listQuery, deviceId).then(function (response) {\n        _this2.list = response.data.records;\n        _this2.total = response.data.total;\n        _this2.listLoading = false;\n      });\n    },\n    getDeviceList: function getDeviceList(str) {\n      var _this3 = this;\n\n      var listQuery = {\n        pageIndex: 1,\n        pageSize: 999,\n        keyword: str,\n        name: str,\n        code: null,\n        state: null,\n        pageSorts: []\n      };\n      var isAdmin = JSON.parse(sessionStorage.userInfo).loginSysUserVo.permissionCodes.includes(\"admin:device:page\");\n      deviceApi.getPageList(listQuery, isAdmin).then(function (response) {\n        _this3.deviceList = response.data.records;\n      });\n    },\n    handleFilter: function handleFilter() {\n      this.listQuery.pageIndex = 1;\n      this.listQuery.keyword = null;\n      this.listQuery.name = null;\n      this.listQuery.code = null;\n      this.listQuery[this.searchColumn] = this.searchValue;\n      this.getPageListBydid(this.deviceId);\n    },\n    setDefaultSort: function setDefaultSort() {\n      // 设置默认排序\n      this.listQuery.pageSorts = [{\n        column: this.sortColumn,\n        asc: this.sortAsc\n      }];\n    },\n    sortChange: function sortChange(data) {\n      var prop = data.prop,\n          order = data.order;\n\n      if (prop === \"createTime\") {\n        this.sortColumn = \"create_time\";\n      } else {\n        this.sortColumn = prop;\n      }\n\n      this.sortAsc = order === \"ascending\";\n      this.listQuery.pageSorts = [{\n        column: this.sortColumn,\n        asc: this.sortAsc\n      }];\n      this.handleFilter();\n    },\n    getSortClass: function getSortClass(key) {\n      if (this.sortColumn === key) {\n        return this.sortAsc ? \"ascending\" : \"descending\";\n      } else {\n        return \"\";\n      }\n    },\n    handleAdd: function handleAdd() {\n      var _this4 = this;\n\n      this.dialogStatus = \"create\";\n      this.$nextTick(function () {\n        _this4.$refs.addPage.handle();\n      });\n    },\n    handDetail: function handDetail(id) {\n      var _this5 = this;\n\n      this.$nextTick(function () {\n        _this5.$refs.detailPage.handle(id);\n      });\n    },\n    handUpdate: function handUpdate(id) {\n      var _this6 = this;\n\n      this.$nextTick(function () {\n        _this6.$refs.updatePage.handle(id);\n      });\n    },\n    handCopy: function handCopy(id) {\n      var _this7 = this;\n\n      this.$nextTick(function () {\n        _this7.$refs.copyPage.handle(id);\n      });\n    },\n    handleDelete: function handleDelete(id, name) {\n      var _this8 = this;\n\n      this.$confirm(\"您确定要删除 \" + name + \" ?\", \"删除提示\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        type: \"warning\"\n      }).then(function () {\n        productApi.delete(id).then(function (response) {\n          if (response.code === 200) {\n            _this8.$message({\n              type: \"success\",\n              message: \"删除成功!\"\n            });\n\n            _this8.handleFilter();\n          }\n        });\n      });\n    },\n    // 选择设备\n    handleDeviceChange: function handleDeviceChange(deviceId) {\n      var _this9 = this;\n\n      if (deviceId) {\n        // get product\n        this.deviceId = deviceId;\n        this.getPageListBydid(deviceId); // tag\n\n        this.deviceList.find(function (item) {\n          if (item.id === deviceId) {\n            var ids = _this9.tags.map(function (idItem) {\n              return idItem.id;\n            });\n\n            if (ids.indexOf(deviceId) < 0) {\n              _this9.tags.push({\n                name: \"\".concat(item.username, \" : \").concat(item.dname),\n                type: \"info\",\n                id: item.id\n              });\n            }\n          }\n        });\n      } else {\n        // this.getPageListBydid();\n        this.list = [];\n      }\n    },\n    // tag click\n    handleTagClick: function handleTagClick(tag, index) {\n      this.deviceId = tag.id;\n      this.getPageListBydid(tag.id);\n      this.selectTag = _objectSpread(_objectSpread({}, tag), {}, {\n        index: index\n      });\n    },\n    // tag close\n    handleClose: function handleClose(tag) {\n      if (tag.id === this.selectTag.id) {\n        this.deviceId = \"\";\n      }\n\n      this.tags.splice(this.tags.indexOf(tag), 1);\n    },\n    // 拷贝\n    handleCopy: function handleCopy(row) {\n      this.copyObj = row;\n    },\n    handleCancelCopy: function handleCancelCopy() {\n      this.copyObj = {};\n    },\n    handleDoCopy: function handleDoCopy(copyObj) {\n      var _this10 = this;\n\n      productApi.copy(this.deviceId, copyObj).then(function (res) {\n        _this10.copyObj = {};\n\n        _this10.getPageListBydid(_this10.deviceId);\n      }); // .catch((err) => {\n      // });\n    },\n    handleCopyedit: function handleCopyedit(copyObj) {\n      this.handleDoCopy(copyObj);\n    },\n    // page change\n    handlePageChange: function handlePageChange() {\n      this.deviceId ? this.getPageListBydid(this.deviceId) : this.getList();\n    }\n  }\n};",null]}