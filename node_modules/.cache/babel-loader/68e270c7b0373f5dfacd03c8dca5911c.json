{"remainingRequest":"D:\\Desktop\\pagepro\\lsying\\node_modules\\thread-loader\\dist\\cjs.js!D:\\Desktop\\pagepro\\lsying\\node_modules\\babel-loader\\lib\\index.js!D:\\Desktop\\pagepro\\lsying\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\Desktop\\pagepro\\lsying\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Desktop\\pagepro\\lsying\\src\\views\\system\\sys-user\\components\\sys-user.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\Desktop\\pagepro\\lsying\\src\\views\\system\\sys-user\\components\\sys-user.vue","mtime":1609569561000},{"path":"D:\\Desktop\\pagepro\\lsying\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Desktop\\pagepro\\lsying\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Desktop\\pagepro\\lsying\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\Desktop\\pagepro\\lsying\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Desktop\\pagepro\\lsying\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport sysUserApi from '@/api/system/sys-user-api';\nimport sysDepartmentApi from '@/api/system/sys-department-api';\nimport sysRoleApi from '@/api/system/sys-role-api';\nimport TreeSelect from '@/components/TreeSelect';\nexport default {\n  name: 'SysUser',\n  components: {\n    TreeSelect: TreeSelect\n  },\n  props: {\n    // detail: 详细页面，add: 添加页面，update：编辑页面\n    isDetail: {\n      type: Boolean,\n      default: false\n    },\n    isAdd: {\n      type: Boolean,\n      default: false\n    },\n    isUpdate: {\n      type: Boolean,\n      default: false\n    }\n  },\n  data: function data() {\n    return {\n      dialogVisible: false,\n      dialogTitle: null,\n      form: {\n        id: null,\n        username: null,\n        nickname: null,\n        phone: null,\n        gender: null,\n        head: null,\n        remark: null,\n        state: 1,\n        departmentId: null,\n        roleId: null,\n        deleted: null\n      },\n      departmentName: null,\n      updateId: null,\n      departmentOptions: null,\n      roleOptions: null,\n      treeSelectData: null,\n      rules: {\n        username: [{\n          required: true,\n          message: '请输入用户账号',\n          trigger: 'blur'\n        }, {\n          min: 4,\n          max: 16,\n          message: '长度在 4 到 16 个字符',\n          trigger: 'blur'\n        }],\n        nickname: [{\n          required: true,\n          message: '请输入用户名称',\n          trigger: 'blur'\n        }, {\n          min: 2,\n          max: 10,\n          message: '长度在 2 到 10 个字符',\n          trigger: 'blur'\n        }],\n        phone: [{\n          required: true,\n          message: '请输入手机号码',\n          trigger: 'blur'\n        }, {\n          min: 11,\n          max: 11,\n          message: '长度11个字符',\n          trigger: 'blur'\n        }],\n        departmentId: [{\n          required: true,\n          message: '请选择部门',\n          trigger: 'change'\n        }],\n        roleId: [{\n          required: true,\n          message: '请选择角色',\n          trigger: 'change'\n        }],\n        state: [{\n          required: true,\n          message: '请选择状态',\n          trigger: 'change'\n        }],\n        remark: [{\n          max: 100,\n          message: '长度100个字符',\n          trigger: 'blur'\n        }]\n      }\n    };\n  },\n  computed: {},\n  created: function created() {},\n  mounted: function mounted() {},\n  methods: {\n    handle: function handle(id) {\n      if (this.isDetail) {\n        this.rules = null;\n        this.dialogTitle = '系统用户详情';\n        this.getUserDetail(id);\n      } else if (this.isAdd) {\n        this.dialogTitle = '新增系统用户';\n        this.getDepartmentTree();\n        this.getRoleList();\n      } else if (this.isUpdate) {\n        this.dialogTitle = '修改系统用户';\n        this.updateId = id;\n        this.getUserDetail(id);\n        this.getDepartmentTree();\n        this.getRoleList();\n      }\n\n      this.dialogVisible = true;\n    },\n    getDepartmentTree: function getDepartmentTree() {\n      var _this = this;\n\n      sysDepartmentApi.getDepartmentTree().then(function (response) {\n        _this.treeSelectData = response.data;\n      });\n    },\n    getRoleList: function getRoleList() {\n      var _this2 = this;\n\n      sysRoleApi.getList().then(function (response) {\n        _this2.roleOptions = response.data;\n        console.log(_this2.roleOptions);\n      });\n    },\n    submitAddForm: function submitAddForm() {\n      var _this3 = this;\n\n      console.log(\"form...\");\n      console.log(this.form.departmentId);\n      console.log(this.departmentName);\n      this.$refs.sysUserForm.validate(function (valid) {\n        if (valid) {\n          console.log('submit!');\n\n          _this3.addUser(); // this.$emit(\"getList\")\n\n        } else {\n          console.log('error submit!!');\n          return false;\n        }\n      });\n    },\n    submitUpdateForm: function submitUpdateForm() {\n      var _this4 = this;\n\n      this.$refs.sysUserForm.validate(function (valid) {\n        if (valid) {\n          console.log('submit!');\n\n          _this4.updateUser(); // this.$emit(\"getList\")\n\n        } else {\n          console.log('error submit!!');\n          return false;\n        }\n      });\n    },\n    getUserDetail: function getUserDetail(id) {\n      var _this5 = this;\n\n      sysUserApi.detail(id).then(function (response) {\n        if (response.code === 200) {\n          _this5.form = response.data;\n\n          if (_this5.isDetail) {\n            _this5.form.roleId = response.data.roleName;\n          }\n\n          _this5.departmentName = response.data.departmentName;\n        }\n      });\n    },\n    addUser: function addUser() {\n      var _this6 = this;\n\n      console.log(this.form);\n      var addParam = {\n        username: this.form.username,\n        nickname: this.form.nickname,\n        phone: this.form.phone,\n        password: this.form.password,\n        remark: this.form.remark,\n        state: this.form.state,\n        departmentId: this.form.departmentId,\n        roleId: this.form.roleId\n      };\n      sysUserApi.add(addParam).then(function (response) {\n        if (response.code === 200) {\n          _this6.restForm();\n\n          _this6.$message({\n            message: '保存系统用户成功',\n            type: 'success'\n          });\n\n          _this6.$emit('change');\n        }\n      });\n    },\n    updateUser: function updateUser() {\n      var _this7 = this;\n\n      var updateParam = {\n        id: this.updateId,\n        nickname: this.form.nickname,\n        phone: this.form.phone,\n        remark: this.form.remark,\n        state: this.form.state,\n        departmentId: this.form.departmentId,\n        roleId: this.form.roleId\n      };\n      sysUserApi.update(updateParam).then(function (response) {\n        if (response.code === 200) {\n          _this7.restForm();\n\n          _this7.$message({\n            message: '修改系统用户成功',\n            type: 'success'\n          });\n\n          _this7.$emit('change');\n        }\n      });\n    },\n    restForm: function restForm() {\n      this.$refs.sysUserForm.resetFields();\n      this.dialogVisible = false;\n    }\n  }\n};",null]}