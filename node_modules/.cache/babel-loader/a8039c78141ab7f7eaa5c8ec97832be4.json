{"remainingRequest":"C:\\Users\\r7000\\Desktop\\pagepro\\lsying\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\r7000\\Desktop\\pagepro\\lsying\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\r7000\\Desktop\\pagepro\\lsying\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\r7000\\Desktop\\pagepro\\lsying\\src\\views\\system\\sys-user\\components\\sys-user-head.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\r7000\\Desktop\\pagepro\\lsying\\src\\views\\system\\sys-user\\components\\sys-user-head.vue","mtime":1609569561000},{"path":"C:\\Users\\r7000\\Desktop\\pagepro\\lsying\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\r7000\\Desktop\\pagepro\\lsying\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\r7000\\Desktop\\pagepro\\lsying\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\r7000\\Desktop\\pagepro\\lsying\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireDefault = require(\"C:/Users/r7000/Desktop/pagepro/lsying/node_modules/@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _sysUserApi = _interopRequireDefault(require(\"@/api/system/sys-user-api\"));\n\nvar _uploadApi = _interopRequireDefault(require(\"@/api/system/upload-api\"));\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nvar _default = {\n  name: 'SysUserHead',\n  data: function data() {\n    return {\n      dialogVisible: false,\n      id: null,\n      imageUrl: null,\n      uploadFileList: []\n    };\n  },\n  created: function created() {},\n  watch: {\n    dialogVisible: function dialogVisible() {\n      if (!this.dialogVisible) {\n        this.uploadFileList = [];\n      }\n    }\n  },\n  methods: {\n    handle: function handle(id, head) {\n      this.id = id;\n      this.imageUrl = head;\n      console.log(this.id);\n      console.log(this.imageUrl);\n      this.dialogVisible = true;\n    },\n    handleChange: function handleChange(file, fileList) {\n      // 将最后一个选择的文件赋值给文件列表\n      if (fileList && fileList.length > 1) {\n        fileList = [file];\n      }\n\n      this.uploadFileList = fileList;\n      this.imageUrl = URL.createObjectURL(file.raw);\n    },\n    handleError: function handleError() {\n      this.$message({\n        message: '上传错误',\n        type: 'error'\n      });\n    },\n    handleBeforeUpload: function handleBeforeUpload(file) {\n      var isLt2M = file.size / 1024 / 1024 < 2;\n\n      if (!isLt2M) {\n        this.$message.error('头像大小不能超过 2MB!');\n      }\n\n      return isLt2M;\n    },\n    submitForm: function submitForm() {\n      var _this = this;\n\n      if (this.uploadFileList.length === 0) {\n        this.$message({\n          message: '请选择文件',\n          type: 'error'\n        });\n      }\n\n      this.$nextTick(function () {\n        _this.$refs.upload.submit();\n      });\n    },\n    resetForm: function resetForm() {\n      var _this2 = this;\n\n      this.dialogVisible = false;\n      this.uploadFileList = [];\n      this.$nextTick(function () {\n        _this2.$refs.upload.clearFiles();\n      });\n    },\n    handleUpload: function handleUpload(param) {\n      var _this3 = this;\n\n      var formData = new FormData();\n      formData.append(\"file\", param.file);\n      formData.append(\"type\", 'head'); // 文件上传后，调用修改用户头像方法\n\n      _uploadApi.default.upload(formData).then(function (response) {\n        if (response.code === 200) {\n          _this3.imageUrl = response.data;\n        } else {\n          throw response.message;\n        }\n      }).then(function () {\n        // 修改头像\n        _sysUserApi.default.uploadHead({\n          id: _this3.id,\n          head: _this3.imageUrl\n        }).then(function (response) {\n          if (response && response.code === 200) {\n            _this3.$message({\n              message: '上传头像成功',\n              type: 'success'\n            });\n\n            _this3.resetForm();\n\n            _this3.$emit('change');\n          }\n        });\n      });\n    }\n  }\n};\nexports.default = _default;",null]}