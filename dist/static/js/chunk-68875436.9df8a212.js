(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-68875436"],{"30d2":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container",attrs:{id:"device-list"}},[i("div",{staticClass:"filter-container"},[i("el-select",{attrs:{filterable:"",remote:"","reserve-keyword":"",clearable:"","remote-method":e.getDeviceList,placeholder:"请选择设备"},on:{change:e.handleDeviceChange},model:{value:e.deviceId,callback:function(t){e.deviceId=t},expression:"deviceId"}},e._l(e.deviceList,(function(e){return i("el-option",{key:e.id,attrs:{label:e.username+"："+e.did,value:e.id}})})),1),e._v(" "),e.isGetAllList?i("el-button",{attrs:{type:"primary"},on:{click:e.getList}},[e._v("获取所有商品")]):e._e(),e._v(" "),e.deviceId?i("el-button",{staticStyle:{"margin-left":"10px",width:"92px"},attrs:{type:"primary",icon:"el-icon-edit"},on:{click:e.handleAdd}},[e._v("添加\n    ")]):e._e(),e._v(" "),e._l(e.tags,(function(t,a){return i("el-tag",{key:t.name,staticStyle:{cursor:"pointer"},attrs:{closable:"",type:e.selectTag.id===t.id?"":"info"},on:{close:function(i){return e.handleClose(t)},click:function(i){return e.handleTagClick(t,a)}}},[e._v("\n      "+e._s(t.name)+"\n    ")])})),e._v(" "),e._v("\n    "+e._s(Object.keys(e.copyObj).length>0?"[已复制"+e.copyObj.name+"]":"")+"\n    "),Object.keys(e.copyObj).length>0?i("el-button",{attrs:{type:"text"},on:{click:e.handleCancelCopy}},[e._v("[取消]")]):e._e(),e._v(" "),e.deviceId&&Object.keys(e.copyObj).length>0?i("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handCopy(e.copyObj.id)}}},[e._v("[修改]")]):e._e(),e._v(" "),e.deviceId&&Object.keys(e.copyObj).length>0?i("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleDoCopy(e.copyObj)}}},[e._v("[粘贴]")]):e._e()],2),e._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],key:e.tableKey,staticStyle:{width:"100%"},attrs:{data:e.list,border:"",fit:"","highlight-current-row":""},on:{"sort-change":e.sortChange}},[i("el-table-column",{attrs:{label:"编号",prop:"id",sortable:"custom",align:"center",width:"80px","class-name":e.getSortClass("id")},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.id))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"用户","min-width":"110px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.username))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"商品图片","min-width":"130px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[a.piclist?i("span",[i("img",{staticClass:"deviceoperate-img",attrs:{src:e.origin+"/api/resource/"+a.piclist.split(";")[0],width:"60px"}})]):e._e()]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"商品名称","min-width":"110px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.name))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"价格","min-width":"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.price))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"所在目录","min-width":"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.firstCategory)+" / "+e._s(a.secondaryCategory)+" /\n          "+e._s(a.threeCategory))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"发货地址","min-width":"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.address))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"发货方式","min-width":"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.deliveryMethod))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"品牌","min-width":"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.brand))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"上下架","min-width":"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("el-tag",{attrs:{type:e._f("stateClassFilter")(a.shelfStatus)}},[i("span",[e._v(e._s(e._f("stateFilter")(a.shelfStatus)))])])]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",width:"240","class-name":"operation"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("el-link",{attrs:{type:"primary"},on:{click:function(t){return e.handDetail(a.id)}}},[e._v("详情")]),e._v(" "),i("el-link",{attrs:{type:"warning"},on:{click:function(t){return e.handUpdate(a.id)}}},[e._v("修改")]),e._v(" "),i("el-link",{attrs:{type:"danger"},on:{click:function(t){return e.handleDelete(a.id,a.name)}}},[e._v("删除")]),e._v(" "),i("el-link",{attrs:{type:"danger"},on:{click:function(t){return e.handleCopy(a)}}},[e._v("拷贝")])]}}])},[i("template",{slot:"header"},[e._v(" 操作 ")])],2)],1),e._v(" "),i("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total > 0"}],attrs:{total:e.total,page:e.listQuery.pageIndex,limit:e.listQuery.pageSize},on:{"update:page":function(t){return e.$set(e.listQuery,"pageIndex",t)},"update:limit":function(t){return e.$set(e.listQuery,"pageSize",t)},pagination:e.handlePageChange}}),e._v(" "),i("device-dialog",{ref:"detailPage",attrs:{"is-detail":""}}),e._v(" "),i("device-dialog",{ref:"addPage",attrs:{"is-add":""},on:{change:function(t){return e.handlePageChange(e.deviceId)}}}),e._v(" "),i("device-dialog",{ref:"updatePage",attrs:{"is-update":""},on:{change:function(t){return e.handlePageChange(e.deviceId)}}}),e._v(" "),i("device-dialog",{ref:"copyPage",attrs:{"is-copy":""},on:{copy:e.handleCopyedit}})],1)},r=[],o=i("5530"),l=(i("7514"),i("6762"),i("2fdb"),i("6724")),s=i("333d"),n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogVisible,"close-on-click-modal":!1,"custom-class":"page-dialog sys-role-dialog"},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("el-form",{ref:"DeviceDialogForm",staticClass:"page-form",staticStyle:{width:"100%"},attrs:{rules:e.rules,model:e.form,"label-position":"right","label-width":"100px",size:"mini"}},[i("el-form-item",{attrs:{label:"商品名",prop:"name"}},[i("el-input",{class:e.form.name.length>37?"deviceoperate-limit":"",attrs:{readonly:e.isDetail,autocomplete:"off"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}}),e._v("\n      "+e._s(e.form.name.length)+"/37\n    ")],1),e._v(" "),i("el-form-item",{attrs:{label:"上架状态",prop:"shelfStatus"}},[i("el-radio-group",{attrs:{disabled:e.isDetail},model:{value:e.form.shelfStatus,callback:function(t){e.$set(e.form,"shelfStatus",t)},expression:"form.shelfStatus"}},[i("el-radio",{attrs:{label:1}},[e._v("上架")]),e._v(" "),i("el-radio",{attrs:{label:0}},[e._v("下架")])],1)],1),e._v(" "),i("el-form-item",{attrs:{label:"价格",prop:"price"}},[i("el-input-number",{attrs:{readonly:e.isDetail,"controls-position":"right",min:300,max:9999999},model:{value:e.form.price,callback:function(t){e.$set(e.form,"price",t)},expression:"form.price"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"一级类目",prop:"firstCategory"}},[i("el-select",{attrs:{filterable:"","allow-create":"","default-first-option":"",placeholder:"一级类目"},model:{value:e.form.firstCategory,callback:function(t){e.$set(e.form,"firstCategory",t)},expression:"form.firstCategory"}},e._l(e.firstCategoryList,(function(e){return i("el-option",{key:e,attrs:{label:e,value:e}})})),1),e._v(" "),i("el-popconfirm",{attrs:{title:"确认清空一级类目缓存吗？"},on:{onConfirm:function(t){return e.clearCategory("firstCategoryList")}}},[i("el-button",{attrs:{slot:"reference",size:"mini"},slot:"reference"},[e._v("清空缓存")])],1)],1),e._v(" "),i("el-form-item",{attrs:{label:"二级类目",prop:"secondaryCategory"}},[i("el-select",{attrs:{filterable:"","allow-create":"","default-first-option":"",placeholder:"二级类目"},model:{value:e.form.secondaryCategory,callback:function(t){e.$set(e.form,"secondaryCategory",t)},expression:"form.secondaryCategory"}},e._l(e.secondaryCategoryList,(function(e){return i("el-option",{key:e,attrs:{label:e,value:e}})})),1),e._v(" "),i("el-popconfirm",{attrs:{title:"确认清空二级类目缓存吗？"},on:{onConfirm:function(t){return e.clearCategory("secondaryCategoryList")}}},[i("el-button",{attrs:{slot:"reference",size:"mini"},slot:"reference"},[e._v("清空缓存")])],1)],1),e._v(" "),i("el-form-item",{attrs:{label:"三级类目",prop:"threeCategory"}},[i("el-select",{attrs:{filterable:"","allow-create":"","default-first-option":"",placeholder:"三级类目"},model:{value:e.form.threeCategory,callback:function(t){e.$set(e.form,"threeCategory",t)},expression:"form.threeCategory"}},e._l(e.threeCategoryList,(function(e){return i("el-option",{key:e,attrs:{label:e,value:e}})})),1),e._v(" "),i("el-popconfirm",{attrs:{title:"确认清空三级类目缓存吗？"},on:{onConfirm:function(t){return e.clearCategory("threeCategoryList")}}},[i("el-button",{attrs:{slot:"reference",size:"mini"},slot:"reference"},[e._v("清空缓存")])],1)],1),e._v(" "),i("el-form-item",{attrs:{label:"品牌",prop:"brand"}},[i("el-input",{attrs:{readonly:e.isDetail},model:{value:e.form.brand,callback:function(t){e.$set(e.form,"brand",t)},expression:"form.brand"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"发货地址",prop:"address"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}},e._l(e.addressList,(function(e){return i("el-option",{key:e.label,attrs:{label:e.label,value:e.label}})})),1)],1),e._v(" "),i("el-form-item",{attrs:{label:"发货方式",prop:"deliveryMethod"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{readonly:e.isDetail,placeholder:"请选择"},model:{value:e.form.deliveryMethod,callback:function(t){e.$set(e.form,"deliveryMethod",t)},expression:"form.deliveryMethod"}},[i("el-option",{attrs:{value:"普通郵便（定形、定形外）",label:"普通郵便（定形、定形外）"}}),e._v(" "),i("el-option",{attrs:{value:"レターパック",label:"レターパック"}}),e._v(" "),i("el-option",{attrs:{value:"ゆうゆうメルカリ便",label:"ゆうゆうメルカリ便"}}),e._v(" "),i("el-option",{attrs:{value:"未定",label:"未定"}})],1)],1),e._v(" "),i("el-form-item",{attrs:{label:"运费承担人",prop:"freightPayer"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{readonly:e.isDetail,placeholder:"请选择"},model:{value:e.form.freightPayer,callback:function(t){e.$set(e.form,"freightPayer",t)},expression:"form.freightPayer"}},[i("el-option",{attrs:{value:"送料込み（出品者負担）",label:"送料込み（出品者負担）"}}),e._v(" "),i("el-option",{attrs:{value:"着払い（購入者負担）",label:"着払い（購入者負担）"}})],1)],1),e._v(" "),i("el-form-item",{attrs:{label:"发货日期",prop:"deliveryDate"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{readonly:e.isDetail,placeholder:"请选择"},model:{value:e.form.deliveryDate,callback:function(t){e.$set(e.form,"deliveryDate",t)},expression:"form.deliveryDate"}},[i("el-option",{attrs:{value:"1～2日で発送",label:"1～2日で発送"}}),e._v(" "),i("el-option",{attrs:{value:"2～3日で発送",label:"2～3日で発送"}}),e._v(" "),i("el-option",{attrs:{value:"4～7日で発送",label:"4～7日で発送"}})],1)],1),e._v(" "),i("el-form-item",{attrs:{label:"新旧程度",prop:"onstate"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{readonly:e.isDetail,placeholder:"请选择"},model:{value:e.form.onstate,callback:function(t){e.$set(e.form,"onstate",t)},expression:"form.onstate"}},[i("el-option",{attrs:{value:"新品、未使用",label:"新品、未使用"}}),e._v(" "),i("el-option",{attrs:{value:"未使用に近い",label:"未使用に近い"}}),e._v(" "),i("el-option",{attrs:{value:"目立った傷や汚れなし",label:"目立った傷や汚れなし"}})],1)],1),e._v(" "),i("el-form-item",{attrs:{label:"商品描述",prop:"description"}},[i("el-input",{attrs:{id:e.form.description.length>1e3?"deviceoperate-description":"",type:"textarea",rows:30,readonly:e.isDetail,placeholder:"请输入内容"},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}}),e._v("\n      "+e._s(e.form.description.length)+"/1000\n      ")],1),e._v(" "),i("el-form-item",{attrs:{label:"截图范围 距左侧随机数开始"}},[i("el-input",{attrs:{placeholder:"距左侧随机数开始",readonly:e.isDetail},model:{value:e.form.leftstart,callback:function(t){e.$set(e.form,"leftstart",t)},expression:"form.leftstart"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"截图范围 距左侧随机数结束"}},[i("el-input",{attrs:{placeholder:"距左侧随机数结束",prop:"leftend",readonly:e.isDetail},model:{value:e.form.leftend,callback:function(t){e.$set(e.form,"leftend",t)},expression:"form.leftend"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"截图范围 距上侧随机数开始"}},[i("el-input",{attrs:{placeholder:"距上侧随机数开始",prop:"upstart",readonly:e.isDetail},model:{value:e.form.upstart,callback:function(t){e.$set(e.form,"upstart",t)},expression:"form.upstart"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"截图范围 距上侧随机数结束"}},[i("el-input",{attrs:{placeholder:"距上侧随机数结束",prop:"upend",readonly:e.isDetail},model:{value:e.form.upend,callback:function(t){e.$set(e.form,"upend",t)},expression:"form.upend"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"展示图",prop:"piclist"}},[i("el-upload",{ref:"upload",attrs:{multiple:"",action:"","on-change":e.fileChange,"on-remove":e.removeFile,"file-list":e.fileList,"auto-upload":!1}},[i("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("选取文件（最少一张）")]),e._v(" "),e.fileList.length>0?i("el-button",{attrs:{icon:"el-icon-upload",type:"primary"},on:{click:e.saveFile}},[e._v("开始上传")]):e._e()],1),e._v(" "),e.form.piclist&&e.form.piclist.length>0?i("div",e._l(e.form.piclist.split(";"),(function(t,a){return i("div",{key:t,staticClass:"deviceoperate-img-con",attrs:{draggable:"true"},on:{dragstart:function(i){return e.handleDragStart(i,a,t)},dragover:function(i){return e.handleDragOver(i,a,t)},drop:function(i){return e.handleDrop(i,a,t)}}},[i("img",{staticClass:"deviceoperate-img",attrs:{src:e.origin+"/api/resource/"+t,width:"120px"}}),e._v(" "),i("div",{staticClass:"deviceoperate-img-delete",on:{click:function(i){return e.handleDeleteImg(t,a)}}},[e._v("删除")])])})),0):e._e()],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e.isDetail?[i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("关闭")])]:e.isAdd?[i("el-button",{on:{click:function(t){return e.restForm()}}},[e._v("取消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitAddForm()}}},[e._v("保存")])]:e.isUpdate?[i("el-button",{on:{click:function(t){return e.restForm()}}},[e._v("取消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitUpdateForm()}}},[e._v("修改")])]:e.isCopy?[i("el-button",{on:{click:function(t){return e.restForm()}}},[e._v("取消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitCopyForm()}}},[e._v("拷贝")])]:e._e()],2),e._v(" "),i("UserDialog",{ref:"userDialog",on:{save:e.handleSave}})],1)},c=[],d=(i("4f7f"),i("5df3"),i("1c4c"),i("ac6a"),i("28a5"),i("7f7f"),i("c5f6"),i("b775")),u=i("bc3a"),f=i.n(u),p={getPageList:function(e){return Object(d["a"])({url:"/commodity/getPageList",method:"post",data:e})},getPageListBydid:function(e,t){return Object(d["a"])({url:"/commodity/getPageListBydid/"+t,method:"post",data:e})},detail:function(e){return Object(d["a"])({url:"/commodity/info/"+e,method:"get"})},add:function(e){return Object(d["a"])({url:"/commodity/add",method:"post",data:e})},update:function(e){return Object(d["a"])({url:"/commodity/update",method:"post",data:e})},delete:function(e){return Object(d["a"])({url:"/commodity/delete/"+e,method:"post"})},copy:function(e,t){return Object(d["a"])({url:"/commodity/copy/"+e,method:"post",data:t})},upload:function(e){return console.log(e.get("token"),"=-=========="),f()({method:"post",url:"http://116.62.196.62:8888/api/commodity/upload",headers:{"Content-Type":"application/json"},data:e})}},m=p,g=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{attrs:{"append-to-body":"",width:"80%",title:e.dialogTitle,visible:e.dialogVisible,"custom-class":"page-dialog sys-role-dialog"},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("SysUserList",{attrs:{"is-pick":!0},on:{save:e.handleSave}}),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){return e.restForm()}}},[e._v("取消")]),e._v(" "),e.row.id?i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitAddForm()}}},[e._v("保存")]):e._e()],1)],1)},h=[],v=i("528b"),y={name:"DeviceUserDialog",components:{SysUserList:v["default"]},props:{},data:function(){return{dialogVisible:!1,dialogTitle:null,row:{}}},computed:{},created:function(){},methods:{handle:function(e){this.dialogVisible=!0},submitAddForm:function(){this.$emit("save",this.row),this.dialogVisible=!1},restForm:function(){this.dialogVisible=!1},handleSave:function(e){this.row=e}}},b=y,_=(i("d6dc"),i("2877")),C=Object(_["a"])(b,g,h,!1,null,"7df79496",null),k=C.exports,L={name:"DeviceDialog",components:{UserDialog:k},props:{isDetail:{type:Boolean,default:!1},isAdd:{type:Boolean,default:!1},isUpdate:{type:Boolean,default:!1},isCopy:{type:Boolean,default:!1}},data:function(){return{dialogVisible:!1,dialogTitle:null,form:{id:0,did:0,name:"",code:"",price:"",firstCategory:"",secondaryCategory:"",threeCategory:"",brand:"",address:"",deliveryMethod:"",freightPayer:"",deliveryDate:"",onstate:"",shelfStatus:0,piclist:"",description:"",createTime:"",updateTime:"",deleted:0,commoditynum:0,upend:"30",upstart:"10",leftend:"30",leftstart:"10"},updateId:null,rules:{name:[{required:!0,message:"请输入商品名称",trigger:"blur"}],state:[{required:!0,message:"请选择随机字符",trigger:"change"}],shelfStatus:[{required:!0,message:"请选择上下架状态",trigger:"change"}],price:[{required:!0,message:"请输入价格",trigger:"change"}],firstCategory:[{required:!0,message:"请输入一级类目",trigger:"change"}],secondaryCategory:[{required:!0,message:"请输入二级类目",trigger:"change"}],threeCategory:[{required:!0,message:"请输入三级类目",trigger:"change"}],address:[{required:!0,message:"请输入发货地址",trigger:"change"}],deliveryMethod:[{required:!0,message:"请选择发货方式",trigger:"change"}],freightPayer:[{required:!0,message:"请选择运费承担人",trigger:"change"}],deliveryDate:[{required:!0,message:"请选择发货日期",trigger:"change"}],onstate:[{required:!0,message:"请选择新旧程度",trigger:"change"}],description:[{required:!0,message:"请输入商品描述",trigger:"change"}],leftstart:[{required:!0,message:"请输入距左侧随机数开始",trigger:"change"}],leftend:[{required:!0,message:"请输入距左侧随机数结束",trigger:"change"}],upstart:[{required:!0,message:"请输入距上侧随机数开始",trigger:"change"}],upend:[{required:!0,message:"请输入距上侧随机数结束",trigger:"change"}],piclist:[{required:!0,message:"请上传图片",trigger:"change"}]},addressList:[{value:1,label:"東京都"},{value:2,label:"埼玉県"},{value:3,label:"千葉県"},{value:4,label:"神奈川県"},{value:5,label:"群馬県"},{value:6,label:"大阪府"},{value:7,label:"未定"}],fileList:[],formData:{},origin:window.location.protocol+"//"+window.location.hostname+":8888",dragObj:{index:0,item:{}},dropObj:{index:0,item:{}},firstCategoryList:[],secondaryCategoryList:[],threeCategoryList:[]}},computed:{},created:function(){},methods:{handle:function(e){this.flushCategoryList(),this.isDetail?(console.log("detail..."+e),this.rules=null,this.dialogTitle="商品详情",this.getRoleDetail(e)):this.isAdd?(console.log("add..."),this.dialogTitle="新增商品"):this.isUpdate?(console.log("update..."),this.dialogTitle="修改商品",this.updateId=e,this.getRoleDetail(e)):this.isCopy&&(console.log("copy..."),this.dialogTitle="修改商品",this.updateId=e,this.getRoleDetail(e)),this.dialogVisible=!0},submitAddForm:function(){var e=this;this.$refs.DeviceDialogForm.validate((function(t){if(Number(e.form.leftstart)>Number(e.form.leftend)||Number(e.form.upstart)>Number(e.form.upend))e.$message({type:"error",message:"添加失败，截图范围开始数必须大于结束数"});else if(e.form.name.length>37)e.$message({type:"error",message:"修改失败，商品名超出字数"});else{if(!(e.form.description.length>1e3))return t?(console.log("submit!"),void e.addRole()):(console.log("error submit!!"),!1);e.$message({type:"error",message:"修改失败，商品描述超出字数"})}}))},submitUpdateForm:function(){var e=this;this.$refs.DeviceDialogForm.validate((function(t){if(Number(e.form.leftstart)>Number(e.form.leftend)||Number(e.form.upstart)>Number(e.form.upend))e.$message({type:"error",message:"修改失败，截图范围开始数必须大于结束数"});else if(e.form.name.length>37)e.$message({type:"error",message:"修改失败，商品名超出字数"});else{if(!(e.form.description.length>1e3))return t?(console.log("submit!"),void e.updateRole()):(console.log("error submit!!"),!1);e.$message({type:"error",message:"修改失败，商品描述超出字数"})}}))},submitCopyForm:function(){var e=this;this.$refs.DeviceDialogForm.validate((function(t){if(!t)return console.log("error submit!!"),!1;var i=JSON.parse(JSON.stringify(e.form));e.$emit("copy",i),e.restForm()}))},getRoleDetail:function(e){var t=this;m.detail(e).then((function(e){200===e.code&&(t.form=e.data,t.form.piclist&&(t.fileList=t.form.piclist.split(";")))}))},addRole:function(){var e=this;this.form.deviceId=this.$parent.deviceId,this.form.did=this.$parent.deviceId;var t=this.form;m.add(t).then((function(t){200===t.code&&(e.saveCategory(),e.restForm(),e.$message({message:"保存商品成功",type:"success"}),e.$emit("change"))}))},updateRole:function(){var e=this;m.update(this.form).then((function(t){200===t.code&&(e.saveCategory(),e.restForm(),e.$message({message:"修改商品成功",type:"success"}),e.$emit("change"))}))},restForm:function(){this.$refs.DeviceDialogForm.resetFields(),this.dialogVisible=!1},handOpenUserDialog:function(){var e=this;this.$nextTick((function(){e.$refs.userDialog.handle()}))},handleSave:function(e){},handleRamdenChange:function(e){function t(e){e=e||2;for(var t="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678!@#$%^&*<>/*-+()=~.;|[]{}",i=t.length,a="",r=0;r<e;r++)a+=t.charAt(Math.floor(Math.random()*i));return a}if(1===e){do{var i=t(2)}while(!isNaN(i));this.form.name=i+this.form.name}if(2===e){do{var a=t(2)}while(!isNaN(a));this.form.name=this.form.name+a}},fileChange:function(e,t){this.fileList=t;var i=t.slice(0,t.length-1).find((function(t){return t.name===e.name}));i&&(this.$message.error("当前文件已经存在!"),t.pop())},removeFile:function(e,t){this.fileList=t},saveFile:function(){var e=this,t=this.$refs.upload.uploadFiles,i=new FormData;i.append("token",JSON.parse(sessionStorage.userInfo).token),i.append("deviceid",this.$parent.deviceId),i.append("did",this.$parent.deviceId),i.append("leftend",this.form.leftend),i.append("leftstart",this.form.leftstart),i.append("upend",this.form.upend),i.append("upstart",this.form.upstart),t.forEach((function(e){i.append("files",e.raw)})),m.upload(i).then((function(t){var i=t.data.data.map((function(e){return e.split("/resource/")[1]}));""!==e.form.piclist?""!==i.join(";")&&(e.form.piclist=e.form.piclist+";"+i.join(";")):e.form.piclist=i.join(";"),e.$refs.upload.clearFiles()})).catch((function(e){console.log(e,"---------")}))},cancelUploadFile:function(){this.importList={sysName:"",resName:"",resItemName:"",fileList:""},this.fileList=[]},subFile:function(e){return f()({url:"http://116.62.196.62:8888/api/commodity/upload",method:"post",data:e,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},handleDeleteImg:function(e,t){this.fileList.splice(t,1);var i=this.form.piclist.split(";");i.splice(t,1),this.form.piclist=i.join(";")},handleDragStart:function(e,t,i){this.dragObj={index:t,item:i}},handleDragOver:function(e,t,i){e.preventDefault()},handleDrop:function(e,t,i){this.dropObj={index:t,item:i};var a=this.form.piclist.split(";");a[this.dragObj.index]=this.dropObj.item,a[this.dropObj.index]=this.dragObj.item,this.form.piclist=a.join(";")},saveCategory:function(){localStorage.firstCategoryList||(localStorage.firstCategoryList=[]);var e=localStorage.firstCategoryList.split(",");e.push(this.form.firstCategory),localStorage.firstCategoryList=Array.from(new Set(e)),localStorage.secondaryCategoryList||(localStorage.secondaryCategoryList=[]);var t=localStorage.secondaryCategoryList.split(",");t.push(this.form.secondaryCategory),localStorage.secondaryCategoryList=Array.from(new Set(t)),console.log(t),localStorage.threeCategoryList||(localStorage.threeCategoryList=[]);var i=localStorage.threeCategoryList.split(",");i.push(this.form.threeCategory),localStorage.threeCategoryList=Array.from(new Set(i)),console.log(i)},clearCategory:function(e){localStorage.removeItem(e),this.flushCategoryList(),this.$message.success("缓存清除成功")},flushCategoryList:function(){localStorage.firstCategoryList?this.firstCategoryList=localStorage.firstCategoryList.split(",").filter((function(e){if(e)return e})):this.firstCategoryList=[],localStorage.secondaryCategoryList?this.secondaryCategoryList=localStorage.secondaryCategoryList.split(",").filter((function(e){if(e)return e})):this.secondaryCategoryList=[],localStorage.threeCategoryList?this.threeCategoryList=localStorage.threeCategoryList.split(",").filter((function(e){if(e)return e})):this.threeCategoryList=[]}}},w=L,S=(i("35e77"),i("7d7b"),Object(_["a"])(w,n,c,!1,null,"451dc7c7",null)),D=S.exports,x=i("6269"),$={0:"已下架",1:"已上架"},O={0:"danger",1:"success"},j={name:"DeviceList",components:{DeviceDialog:D,Pagination:s["a"]},directives:{waves:l["a"]},filters:{statusFilter:function(e){return 0===e?"info":1===e?"success":2===e?"warning":void 0},stateClassFilter:function(e){return O[e]},stateFilter:function(e){return $[e]}},data:function(){return{tableKey:0,list:null,deviceList:null,total:0,listLoading:!1,sortColumn:"id",sortAsc:!1,listQuery:{pageIndex:1,pageSize:10,keyword:null,name:null,code:null,state:null,pageSorts:[]},stateOptions:[{label:"已删除",value:1},{label:"未删除",value:0}],tableColumnChecked:null,searchColumn:"keyword",searchValue:null,searchOptions:[{label:"全部",value:"keyword"},{label:"角色名称",value:"name"},{label:"角色编码",value:"code"}],createTimeRange:null,showReviewer:!0,dialogStatus:"",textMap:{update:"Edit",create:"Create"},dialogPvVisible:!1,pvData:[],downloadLoading:!1,deviceId:"",copyObj:{},origin:window.location.protocol+"//"+window.location.hostname+":8888",isGetAllList:!1,tags:[],selectTag:{}}},created:function(){this.setDefaultSort(),this.getDeviceList(),this.isGetAllList=JSON.parse(sessionStorage.userInfo).loginSysUserVo.permissionCodes.includes("admin:commodity:page")},methods:{getList:function(){var e=this;this.deviceId="",this.listLoading=!0,m.getPageList(this.listQuery).then((function(t){e.list=t.data.records,e.total=t.data.total,e.listLoading=!1}))},getPageListBydid:function(e){var t=this;e?(this.listLoading=!0,m.getPageListBydid(this.listQuery,e).then((function(e){t.list=e.data.records,t.total=e.data.total,t.listLoading=!1}))):this.$message.warning("请选择设备后在操作")},getDeviceList:function(e){var t=this,i={pageIndex:1,pageSize:999,keyword:e,name:e,code:null,state:null,pageSorts:[]},a=JSON.parse(sessionStorage.userInfo).loginSysUserVo.permissionCodes.includes("admin:device:page");x["a"].getPageList(i,a).then((function(e){t.deviceList=e.data.records}))},handleFilter:function(){this.listQuery.pageIndex=1,this.listQuery.keyword=null,this.listQuery.name=null,this.listQuery.code=null,this.listQuery[this.searchColumn]=this.searchValue,this.getPageListBydid(this.deviceId)},setDefaultSort:function(){this.listQuery.pageSorts=[{column:this.sortColumn,asc:this.sortAsc}]},sortChange:function(e){var t=e.prop,i=e.order;this.sortColumn="createTime"===t?"create_time":t,this.sortAsc="ascending"===i,this.listQuery.pageSorts=[{column:this.sortColumn,asc:this.sortAsc}],this.handleFilter()},getSortClass:function(e){return this.sortColumn===e?this.sortAsc?"ascending":"descending":""},handleAdd:function(){var e=this;this.dialogStatus="create",this.$nextTick((function(){e.$refs.addPage.handle()}))},handDetail:function(e){var t=this;this.$nextTick((function(){t.$refs.detailPage.handle(e)}))},handUpdate:function(e){var t=this;this.$nextTick((function(){t.$refs.updatePage.handle(e)}))},handCopy:function(e){var t=this;this.$nextTick((function(){t.$refs.copyPage.handle(e)}))},handleDelete:function(e,t){var i=this;this.$confirm("您确定要删除 "+t+" ?","删除提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){m.delete(e).then((function(e){200===e.code&&(i.$message({type:"success",message:"删除成功!"}),i.handleFilter())}))}))},handleDeviceChange:function(e){var t=this;e?(this.deviceId=e,this.getPageListBydid(e),this.deviceList.find((function(i){if(i.id===e){var a=t.tags.map((function(e){return e.id}));a.indexOf(e)<0&&t.tags.push({name:"".concat(i.username," : ").concat(i.dname),type:"info",id:i.id})}}))):this.list=[]},handleTagClick:function(e,t){this.deviceId=e.id,this.getPageListBydid(e.id),this.selectTag=Object(o["a"])(Object(o["a"])({},e),{},{index:t})},handleClose:function(e){e.id===this.selectTag.id&&(this.deviceId=""),this.tags.splice(this.tags.indexOf(e),1)},handleCopy:function(e){this.copyObj=e},handleCancelCopy:function(){this.copyObj={}},handleDoCopy:function(e){var t=this;m.copy(this.deviceId,e).then((function(e){t.copyObj={},t.getPageListBydid(t.deviceId)}))},handleCopyedit:function(e){this.handleDoCopy(e)},handlePageChange:function(){this.deviceId?this.getPageListBydid(this.deviceId):this.getList()}}},F=j,I=(i("7096"),Object(_["a"])(F,a,r,!1,null,null,null));t["default"]=I.exports},"35e77":function(e,t,i){"use strict";i("3929")},3929:function(e,t,i){},"4eac":function(e,t,i){},6269:function(e,t,i){"use strict";var a=i("b775"),r={getPageList:function(e,t){var i=t?"/deviceCommodity/getPageList":"/deviceCommodity/getPageListByuser";return Object(a["a"])({url:i,method:"post",data:e})},detail:function(e){return Object(a["a"])({url:"/deviceCommodity/info/"+e,method:"get"})},add:function(e){return Object(a["a"])({url:"/deviceCommodity/add",method:"post",data:e})},update:function(e){return Object(a["a"])({url:"/deviceCommodity/update",method:"post",data:e})},delete:function(e){return Object(a["a"])({url:"/deviceCommodity/delete/"+e,method:"post"})}};t["a"]=r},7096:function(e,t,i){"use strict";i("dbcd")},7514:function(e,t,i){"use strict";var a=i("5ca1"),r=i("0a49")(5),o="find",l=!0;o in[]&&Array(1)[o]((function(){l=!1})),a(a.P+a.F*l,"Array",{find:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}}),i("9c6c")(o)},"7d7b":function(e,t,i){"use strict";i("e95a")},d6dc:function(e,t,i){"use strict";i("4eac")},dbcd:function(e,t,i){},e95a:function(e,t,i){}}]);